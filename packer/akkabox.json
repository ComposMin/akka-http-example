{
  "variables": {
    "source_ami": ""
  },
  "builders": [
    {
      "type": "amazon-ebs",
      "instance_type": "t1.micro",
      "ssh_username": "ec2-user",
      "ami_name": "akka-http-example {{timestamp}}",
      "ami_block_device_mappings": [ {
        "device_name": "/dev/sda1",
        "volume_size": 100,
        "delete_on_termination": true
      } ],
      "launch_block_device_mappings": [ {
        "device_name": "/dev/sda1",
        "volume_size": 100,
        "delete_on_termination": true
      } ],
      "run_tags": {
        "Name": "Packer builder"
      },
      "tags": {
        "Description": "Generated by Packer Build"
      },
      "ssh_timeout": "10m",
      "region": "ap-southeast-2",
      "ami_users": [
        "911868327851"
      ],
      "source_ami": "{{user `source_ami`}}"
    }
  ],
  "provisioners": [
    {
      "type": "shell",
      "inline": [
        "set -x -e",
        "echo Hello from Packer > /tmp/packer-provisioner-ran",
        "date >> /tmp/packer-provisioner-ran"
      ]
    },
    {
      "type": "file",
      "source": "target/scala-2.11/akkaHttpExample-assembly-1.0.0.jar",
      "destination": "/tmp"
    },
    {
      "type": "shell",
      "inline": [
        "set -x -e",
        "mkdir -p /opt/akka-http-example",
        "mv /tmp/akkaHttpExample*assembly*jar /opt/akka-http-example"
      ]
    }
  ]
}
